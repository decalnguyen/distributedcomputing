apiVersion: apps/v1
kind: Deployment 
metadata: 
  labels:
    app: db 
  name: db
spec:
  replicas: 1
  selector:
    matchLabels:
      app: db
  template: 
    metadata:
      labels: 
        app: db
  spec:
    containers: 
    - image: mysql 
      imagePullPolicy: ""
      name: db
      env:
      - name: MYSQL_ROOT_PASSWORD
        valueFrom:
          secretKeyRef:
            name: db-mysecret
            key: rp
      - name: MYSQL_DATABASE
        valueFrom: 
          secretKeyRef:
            name: db-mysecret
            key: db
      ports:
        - containerPort: 3306
      resources:
        requests: 
          cpu: "200m"
          memory: "200Mi"
        limits:
          cpu: "300m"
          memory: "300Mi"
      volumeMounts:
      - mountPath: /var/lib/mysql
        name: mysql-data
---
apiVersion: v1 
kind: Service 
metadata:
  name: db_service
spec: 
  selector:
    app: db
  ports: 
    - protocol: TCP 
      port: 3306
      targetPort: 3306